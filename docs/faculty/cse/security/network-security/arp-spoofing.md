[> Back](../README.md#网络安全)

# ARP 欺骗

Created: November 18, 2021
Sort: Security

## ARP 协议

> **地址解析协议**（**A**ddress **R**esolution **P**rotocol，**ARP**）：一个通过解析网络层地址来找寻数据链路层地址的网络传输协议；也可能指是在多数操作系统中管理其相关地址的一个进程。
—— wiki 百科
> 

以太局域网内数据包传输依靠的是 MAC 地址，IP 地址与 MAC 对应的关系依靠 ARP 表，每台主机（包括网关）都有一个 ARP 缓存表：

- ARP ：同一局域网中，在主机发送帧前，将目标 IP 地址转换成目标 MAC 地址的过程；
- ARP 代理：不同局域网中，目标 IP 地址将转换成可以通往局域网外的路由器的 MAC 地址。

## ARP 欺骗原理

在正常情况下，ARP 缓存表能够有效的保证数据传输的唯一性，但是在 ARP 缓存表的实现机制中存在一个不完善的地方：

- 当主机收到一个 ARP 的应答包后，它并不会去验证自己是否发送过这个 ARP 请求，而是直接将应答包里的 MAC 地址与 IP 对应的关系替换掉原有的 ARP 缓存表里的相应信息。

因此，ARP 欺骗的运作原理是由攻击者发送假的 ARP 数据包到网络上，尤其是送到网关上，这样就能让送至特定的 IP 地址的流量被送到攻击者所取代的地方。

## ARP 欺骗的危害

- 影响局域网正常运行；
- 窃取用户的敏感信息；
- 传播网页木马病毒；
- ......

<aside>
🔑 ARP 欺骗并非总是恶意用途：当服务器宕机时，便可以利用 ARP 欺骗将局域网中的流量引向备用服务器，作为应急处理方案。

</aside>

### Reference

华南师范大学网络中心：[https://nc.scnu.edu.cn/a/20140421/61.html](https://nc.scnu.edu.cn/a/20140421/61.html)